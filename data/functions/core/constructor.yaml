functions:
  # length is probably in the wrong place
  - id: core.length
    kind: elementwise
    params: [{ name: collection, dtype: string }]
    dtype:
      rule: scalar
      kind: integer
    aliases: ["length", "len", "size"]
    folding_class_method: length

  - id: core.array_size
    kind: elementwise
    params: [{ name: collection, dtype: array }]
    dtype:
      rule: scalar
      kind: integer
    aliases: ["array_size", "size"]
    folding_class_method: length

  - id: core.at
    kind: elementwise
    params:
      - { name: collection }
      - { name: index, dtype: integer }
    dtype:
      rule: element_of
      param: collection
    aliases: ["at", "get", "[]"]
    folding_class_method: at

  - id: core.hash_fetch
    kind: elementwise
    params:
      - { name: key, dtype: hash }
    dtype:
      rule: scalar
      kind: any
    aliases: ["fetch"]
    folding_class_method: "[]"