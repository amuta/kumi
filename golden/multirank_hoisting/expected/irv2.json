{
  "version": "0.1",
  "module": "schema_module",
  "declarations": {
    "global_offset_plus": {
      "name": "global_offset_plus",
      "parameters": [{"kind":"input","path":["global_offset"]}],
      "operations": [
        {"id":0,"op":"LoadInput","args":[["global_offset"]],"stamp":{"dtype":"float","axes":[]}},
        {"id":1,"op":"Const","args":[1.0],"stamp":{"dtype":"float","axes":[]}},
        {"id":2,"op":"Map","args":[0,1],"stamp":{"dtype":"float","axes":[]},"attrs":{"fn":"core.add"}}
      ],
      "result": 2
    },
    "batch_bias": {
      "name": "batch_bias",
      "parameters": [{"kind":"input","path":["batch","mean"]},{"kind":"dependency","source":"global_offset_plus"}],
      "operations": [
        {"id":3,"op":"LoadInput","args":[["batch","mean"]],"stamp":{"dtype":"float","axes":["batch"]}},
        {"id":4,"op":"LoadDeclaration","args":["global_offset_plus"],"stamp":{"dtype":"float","axes":[]}},
        {"id":5,"op":"Map","args":[3,4],"stamp":{"dtype":"float","axes":["batch"]},"attrs":{"fn":"core.add"}}
      ],
      "result": 5
    },
    "row_scale2": {
      "name": "row_scale2",
      "parameters": [{"kind":"input","path":["batch","row","scale"]}],
      "operations": [
        {"id":6,"op":"LoadInput","args":[["batch","row","scale"]],"stamp":{"dtype":"float","axes":["batch","row"]}},
        {"id":7,"op":"Const","args":[2.0],"stamp":{"dtype":"float","axes":[]}},
        {"id":8,"op":"Map","args":[6,7],"stamp":{"dtype":"float","axes":["batch","row"]},"attrs":{"fn":"core.mul"}}
      ],
      "result": 8
    },
    "elem_affine": {
      "name": "elem_affine",
      "parameters": [
        {"kind":"input","path":["batch","row","col","val"]},
        {"kind":"dependency","source":"row_scale2"},
        {"kind":"dependency","source":"batch_bias"}
      ],
      "operations": [
        {"id":9,"op":"LoadInput","args":[["batch","row","col","val"]],"stamp":{"dtype":"float","axes":["batch","row","col"]}},
        {"id":10,"op":"LoadDeclaration","args":["row_scale2"],"stamp":{"dtype":"float","axes":["batch","row"]}},
        {"id":11,"op":"Map","args":[9,10],"stamp":{"dtype":"float","axes":["batch","row","col"]},"attrs":{"fn":"core.mul"}},
        {"id":12,"op":"LoadDeclaration","args":["batch_bias"],"stamp":{"dtype":"float","axes":["batch"]}},
        {"id":13,"op":"Map","args":[11,12],"stamp":{"dtype":"float","axes":["batch","row","col"]},"attrs":{"fn":"core.add"}}
      ],
      "result": 13
    },
    "row_sum_affine": {
      "name": "row_sum_affine",
      "parameters": [{"kind":"dependency","source":"elem_affine"}],
      "operations": [
        {"id":14,"op":"LoadDeclaration","args":["elem_affine"],"stamp":{"dtype":"float","axes":["batch","row","col"]}},
        {
          "id": 15,
          "op": "Reduce",
          "args": [14],
          "stamp": {"dtype":"float","axes":["batch","row"]},
          "attrs": {"fn":"agg.sum","axis":"col"}
        }
      ],
      "result": 15
    },
    "batch_total_affine": {
      "name": "batch_total_affine",
      "parameters": [{"kind":"dependency","source":"row_sum_affine"}],
      "operations": [
        {"id":16,"op":"LoadDeclaration","args":["row_sum_affine"],"stamp":{"dtype":"float","axes":["batch","row"]}},
        {"id":17,"op":"Reduce","args":[16],"stamp":{"dtype":"float","axes":["batch"]},"attrs":{"fn":"agg.sum","axis":"row"}}
      ],
      "result": 17
    }
  },
  "analysis": {
    "defaults": {"key_policy":"indifferent","on_missing":"error"},
    "inputs": [
      {
        "path": ["batch"],
        "axes": ["batch"],
        "dtype": "array",
        "key_policy": "indifferent",
        "on_missing": "error",
        "navigation_steps": [{"axes":"batch","path":["batch"],"loop_idx":0,"kind":"array_field","key":"batch"}],
        "leaf_nav": [],
        "terminal": {"kind":"none","dtype":"array","key_policy":"indifferent","on_missing":"error"},
        "path_fqn": "batch"
      },
      {
        "path": ["batch","mean"],
        "axes": ["batch"],
        "dtype": "float",
        "key_policy": "indifferent",
        "on_missing": "error",
        "navigation_steps": [{"axes":"batch","path":["batch"],"loop_idx":0,"kind":"array_field","key":"batch"}],
        "leaf_nav": [{"kind":"field_leaf","key":"mean"}],
        "terminal": {"kind":"none","dtype":"float","key_policy":"indifferent","on_missing":"error"},
        "path_fqn": "batch.mean"
      },
      {
        "path": ["batch","row"],
        "axes": ["batch","row"],
        "dtype": "array",
        "key_policy": "indifferent",
        "on_missing": "error",
        "navigation_steps": [
          {"axes":"batch","path":["batch"],"loop_idx":0,"kind":"array_field","key":"batch"},
          {"axes":"row","path":["batch","row"],"loop_idx":1,"kind":"array_field","key":"row"}
        ],
        "leaf_nav": [],
        "terminal": {"kind":"none","dtype":"array","key_policy":"indifferent","on_missing":"error"},
        "path_fqn": "batch.row"
      },
      {
        "path": ["batch","row","col"],
        "axes": ["batch","row","col"],
        "dtype": "array",
        "key_policy": "indifferent",
        "on_missing": "error",
        "navigation_steps": [
          {"axes":"batch","path":["batch"],"loop_idx":0,"kind":"array_field","key":"batch"},
          {"axes":"row","path":["batch","row"],"loop_idx":1,"kind":"array_field","key":"row"},
          {"axes":"col","path":["batch","row","col"],"loop_idx":2,"kind":"array_field","key":"col"}
        ],
        "leaf_nav": [],
        "terminal": {"kind":"none","dtype":"array","key_policy":"indifferent","on_missing":"error"},
        "path_fqn": "batch.row.col"
      },
      {
        "path": ["batch","row","col","val"],
        "axes": ["batch","row","col"],
        "dtype": "float",
        "key_policy": "indifferent",
        "on_missing": "error",
        "navigation_steps": [
          {"axes":"batch","path":["batch"],"loop_idx":0,"kind":"array_field","key":"batch"},
          {"axes":"row","path":["batch","row"],"loop_idx":1,"kind":"array_field","key":"row"},
          {"axes":"col","path":["batch","row","col"],"loop_idx":2,"kind":"array_field","key":"col"}
        ],
        "leaf_nav": [{"kind":"field_leaf","key":"val"}],
        "terminal": {"kind":"none","dtype":"float","key_policy":"indifferent","on_missing":"error"},
        "path_fqn": "batch.row.col.val"
      },
      {
        "path": ["batch","row","scale"],
        "axes": ["batch","row"],
        "dtype": "float",
        "key_policy": "indifferent",
        "on_missing": "error",
        "navigation_steps": [
          {"axes":"batch","path":["batch"],"loop_idx":0,"kind":"array_field","key":"batch"},
          {"axes":"row","path":["batch","row"],"loop_idx":1,"kind":"array_field","key":"row"}
        ],
        "leaf_nav": [{"kind":"field_leaf","key":"scale"}],
        "terminal": {"kind":"none","dtype":"float","key_policy":"indifferent","on_missing":"error"},
        "path_fqn": "batch.row.scale"
      },
      {
        "path": ["global_offset"],
        "axes": [],
        "dtype": "float",
        "key_policy": "indifferent",
        "on_missing": "error",
        "navigation_steps": [],
        "leaf_nav": [{"kind":"field_leaf","key":"global_offset"}],
        "terminal": {"kind":"none","dtype":"float","key_policy":"indifferent","on_missing":"error"},
        "path_fqn": "global_offset"
      }
    ]
  }
}