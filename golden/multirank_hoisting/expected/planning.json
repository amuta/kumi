{
  "declarations": {
    "global_offset_plus": {
      "axes": [],
      "parameters": [{"kind":"input","path":["global_offset"]}],
      "site_schedule": {
        "max_depth": 0,
        "hoisted_scalars": [{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}],
        "root_reduces": [],
        "by_depth": [{"depth":0,"ops":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}]}]
      },
      "axis_carriers": [],
      "reduce_plans": [],
      "inlining_decisions": {}
    },
    "batch_bias": {
      "axes": ["batch"],
      "parameters": [{"kind":"input","path":["batch","mean"]},{"kind":"dependency","source":"global_offset_plus"}],
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [{"id":4,"kind":"loaddeclaration"}],
        "root_reduces": [],
        "by_depth": [
          {"depth":0,"ops":[{"id":4,"kind":"loaddeclaration"}]},
          {"depth":1,"ops":[{"id":3,"kind":"loadinput"},{"id":5,"kind":"map"}]}
        ]
      },
      "axis_carriers": [{"axis":"batch","via_path":["batch"]}],
      "reduce_plans": [],
      "inlining_decisions": {"op_4":{"producer":"global_offset_plus","decision":"inline","use_site_axes":[]}}
    },
    "row_scale2": {
      "axes": ["batch","row"],
      "parameters": [{"kind":"input","path":["batch","row","scale"]}],
      "site_schedule": {
        "max_depth": 2,
        "hoisted_scalars": [{"id":7,"kind":"const"}],
        "root_reduces": [],
        "by_depth": [
          {"depth":0,"ops":[{"id":7,"kind":"const"}]},
          {"depth":1,"ops":[]},
          {"depth":2,"ops":[{"id":6,"kind":"loadinput"},{"id":8,"kind":"map"}]}
        ]
      },
      "axis_carriers": [{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],
      "reduce_plans": [],
      "inlining_decisions": {}
    },
    "elem_affine": {
      "axes": ["batch","row","col"],
      "parameters": [
        {"kind":"input","path":["batch","row","col","val"]},
        {"kind":"dependency","source":"row_scale2"},
        {"kind":"dependency","source":"batch_bias"}
      ],
      "site_schedule": {
        "max_depth": 3,
        "hoisted_scalars": [],
        "root_reduces": [],
        "by_depth": [
          {"depth":0,"ops":[]},
          {"depth":1,"ops":[{"id":12,"kind":"loaddeclaration"}]},
          {"depth":2,"ops":[{"id":10,"kind":"loaddeclaration"}]},
          {"depth":3,"ops":[{"id":9,"kind":"loadinput"},{"id":11,"kind":"map"},{"id":13,"kind":"map"}]}
        ]
      },
      "axis_carriers": [
        {"axis":"batch","via_path":["batch"]},
        {"axis":"col","via_path":["batch","row","col"]},
        {"axis":"row","via_path":["batch","row"]}
      ],
      "reduce_plans": [],
      "inlining_decisions": {
        "op_10": {"producer":"row_scale2","decision":"inline","use_site_axes":["batch","row"]},
        "op_12": {"producer":"batch_bias","decision":"inline","use_site_axes":["batch"]}
      }
    },
    "row_sum_affine": {
      "axes": ["batch","row"],
      "parameters": [{"kind":"dependency","source":"elem_affine"}],
      "site_schedule": {
        "max_depth": 3,
        "hoisted_scalars": [],
        "root_reduces": [],
        "by_depth": [
          {"depth":0,"ops":[]},
          {"depth":1,"ops":[]},
          {"depth":2,"ops":[{"id":15,"kind":"reduce"}]},
          {"depth":3,"ops":[{"id":14,"kind":"loaddeclaration"}]}
        ]
      },
      "axis_carriers": [{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],
      "reduce_plans": [
        {
          "op_id": 15,
          "axis": "col",
          "arg_id": 14,
          "reducer_fn": "agg.sum",
          "result_depth": 2,
          "reset_depth": 2,
          "contrib_depth": 3,
          "bind_depth": 2,
          "nested": false,
          "via_path": ["batch","row","col"]
        }
      ],
      "inlining_decisions": {"op_14":{"producer":"elem_affine","decision":"inline","use_site_axes":["batch","row","col"]}}
    },
    "batch_total_affine": {
      "axes": ["batch"],
      "parameters": [{"kind":"dependency","source":"row_sum_affine"}],
      "site_schedule": {
        "max_depth": 2,
        "hoisted_scalars": [],
        "root_reduces": [],
        "by_depth": [
          {"depth":0,"ops":[]},
          {"depth":1,"ops":[{"id":17,"kind":"reduce"}]},
          {"depth":2,"ops":[{"id":16,"kind":"loaddeclaration"}]}
        ]
      },
      "axis_carriers": [{"axis":"batch","via_path":["batch"]}],
      "reduce_plans": [
        {
          "op_id": 17,
          "axis": "row",
          "arg_id": 16,
          "reducer_fn": "agg.sum",
          "result_depth": 1,
          "reset_depth": 1,
          "contrib_depth": 2,
          "bind_depth": 1,
          "nested": false,
          "via_path": ["batch","row"]
        }
      ],
      "inlining_decisions": {"op_16":{"producer":"row_sum_affine","decision":"call","use_site_axes":["batch","row"]}}
    }
  }
}