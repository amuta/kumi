{"bindings":{"ruby":{"kernels":[{"attrs":{},"impl":"->(a, b) { a + b }","kernel_id":"core.add"},{"attrs":{},"impl":"->(a, b) { a * b }","kernel_id":"core.mul"},{"attrs":{"identity":0.0},"impl":"->(a,b) { a + b }","kernel_id":"agg.sum"}]}},"capabilities":{"layout":"nested_array"},"declarations":[{"axes":[],"axis_carriers":[],"inlining_decisions":{},"name":"global_offset_plus","operations":[{"args":[["global_offset"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[1.0],"attrs":{},"id":1,"op":"Const"},{"args":[0,1],"attrs":{"fn":"core.add"},"id":2,"op":"Map"}],"parameters":[{"kind":"input","path":["global_offset"]}],"reduce_plans":[],"result_op_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}],"max_depth":0,"root_reduces":[]}},{"axes":["batch"],"axis_carriers":[{"axis":"batch","via_path":["batch"]}],"inlining_decisions":{"op_1":{"decision":"inline","producer":"global_offset_plus","use_site_axes":[]}},"name":"batch_bias","operations":[{"args":[["batch","mean"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":["global_offset_plus"],"attrs":{},"id":1,"op":"LoadDeclaration"},{"args":[0,1],"attrs":{"fn":"core.add"},"id":2,"op":"Map"}],"parameters":[{"kind":"input","path":["batch","mean"]},{"kind":"dependency","source":"global_offset_plus"}],"reduce_plans":[],"result_op_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"loaddeclaration"}]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":1,"kind":"loaddeclaration"}],"max_depth":1,"root_reduces":[]}},{"axes":["batch","row"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{},"name":"row_scale2","operations":[{"args":[["batch","row","scale"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[2.0],"attrs":{},"id":1,"op":"Const"},{"args":[0,1],"attrs":{"fn":"core.mul"},"id":2,"op":"Map"}],"parameters":[{"kind":"input","path":["batch","row","scale"]}],"reduce_plans":[],"result_op_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"const"}]},{"depth":1,"ops":[]},{"depth":2,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":1,"kind":"const"}],"max_depth":2,"root_reduces":[]}},{"axes":["batch","row","col"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"col","via_path":["batch","row","col"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{"op_1":{"decision":"inline","producer":"row_scale2","use_site_axes":["batch","row"]},"op_3":{"decision":"inline","producer":"batch_bias","use_site_axes":["batch"]}},"name":"elem_affine","operations":[{"args":[["batch","row","col","val"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":["row_scale2"],"attrs":{},"id":1,"op":"LoadDeclaration"},{"args":[0,1],"attrs":{"fn":"core.mul"},"id":2,"op":"Map"},{"args":["batch_bias"],"attrs":{},"id":3,"op":"LoadDeclaration"},{"args":[2,3],"attrs":{"fn":"core.add"},"id":4,"op":"Map"}],"parameters":[{"kind":"input","path":["batch","row","col","val"]},{"kind":"dependency","source":"row_scale2"},{"kind":"dependency","source":"batch_bias"}],"reduce_plans":[],"result_op_id":4,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":3,"kind":"loaddeclaration"}]},{"depth":2,"ops":[{"id":1,"kind":"loaddeclaration"}]},{"depth":3,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"},{"id":4,"kind":"map"}]}],"hoisted_scalars":[],"max_depth":3,"root_reduces":[]}},{"axes":["batch","row"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{"op_0":{"decision":"inline","producer":"elem_affine","use_site_axes":["batch","row","col"]}},"name":"row_sum_affine","operations":[{"args":["elem_affine"],"attrs":{},"id":0,"op":"LoadDeclaration"},{"args":[0],"attrs":{"axis":"col","fn":"agg.sum"},"id":1,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"elem_affine"}],"reduce_plans":[{"arg_id":0,"axis":"col","op_id":1,"reducer_fn":"agg.sum","result_depth":2,"via_path":["batch","row","col"]}],"result_op_id":1,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[]},{"depth":2,"ops":[{"id":1,"kind":"reduce"}]},{"depth":3,"ops":[{"id":0,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":3,"root_reduces":[]}},{"axes":["batch"],"axis_carriers":[{"axis":"batch","via_path":["batch"]}],"inlining_decisions":{"op_0":{"decision":"inline","producer":"row_sum_affine","use_site_axes":["batch","row"]}},"name":"batch_total_affine","operations":[{"args":["row_sum_affine"],"attrs":{},"id":0,"op":"LoadDeclaration"},{"args":[0],"attrs":{"axis":"row","fn":"agg.sum"},"id":1,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"row_sum_affine"}],"reduce_plans":[{"arg_id":0,"axis":"row","op_id":1,"reducer_fn":"agg.sum","result_depth":1,"via_path":["batch","row"]}],"result_op_id":1,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":1,"kind":"reduce"}]},{"depth":2,"ops":[{"id":0,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":2,"root_reduces":[]}}],"hashes":{"bindings":"3348fb476948c6dbfbe8fb9cbb7885960f977aa579780d139c16a92351c2d49f","declarations":"8c31af6862e402367dbec7748cf5cd572702826526f41779c3ba768739cf4bd1","inputs":"f997f41b53434964d0cbe4ee0e0d0452a2fa227a8fb1a60a8d38bc44e417b689"},"inputs":[{"accessor_name":"batch","axes":[""],"axis_loops":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]}],"dtype":"array","leaf_nav":[],"name":"batch","path_fqn":"batch","terminal":{"dtype":"array","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_mean","axes":[""],"axis_loops":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]}],"dtype":"float","leaf_nav":[{"key":"mean","kind":"field_leaf"}],"name":"batch.mean","path_fqn":"batch.mean","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row","axes":["",""],"axis_loops":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]}],"dtype":"array","leaf_nav":[],"name":"batch.row","path_fqn":"batch.row","terminal":{"dtype":"array","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row_scale","axes":["",""],"axis_loops":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]}],"dtype":"float","leaf_nav":[{"key":"scale","kind":"field_leaf"}],"name":"batch.row.scale","path_fqn":"batch.row.scale","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row_col","axes":["","",""],"axis_loops":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]},{"axes":"col","key":"col","kind":"array_field","loop_idx":2,"path":["batch","row","col"]}],"dtype":"array","leaf_nav":[],"name":"batch.row.col","path_fqn":"batch.row.col","terminal":{"dtype":"array","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row_col_val","axes":["","",""],"axis_loops":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]},{"axes":"col","key":"col","kind":"array_field","loop_idx":2,"path":["batch","row","col"]}],"dtype":"float","leaf_nav":[{"key":"val","kind":"field_leaf"}],"name":"batch.row.col.val","path_fqn":"batch.row.col.val","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"global_offset","axes":[],"axis_loops":[],"dtype":"float","leaf_nav":[{"key":"global_offset","kind":"field_leaf"}],"name":"global_offset","path_fqn":"global_offset","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}}],"module_id":"schema_module","pack_version":"0.1"}