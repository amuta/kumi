{"bindings":{},"capabilities":{"layout":"nested_array"},"hashes":{"bindings":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","inputs":"4f53cda18c2baa0c0354bb5f9a3ecbe5ed12ab4d8e11ba873c2f11161202b945","ops_by_decl":"3c8f6e7ce1ff5f67453c8b88fe942020bed6f8175c51d13a8549df1becda1cd3","plan":"51a22f051326c850c09644a20387f7cca296d993b503ed23bab6cccf0e4be9e6"},"inputs":[],"module_id":"schema_module","ops_by_decl":{"batch_bias":{"operations":[{"args":[["batch","mean"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":["global_offset_plus"],"attrs":{},"id":1,"op":"LoadDeclaration"},{"args":[0,1],"attrs":{"fn":"core.add"},"id":2,"op":"Map"}],"result":2},"batch_total_affine":{"operations":[{"args":["row_sum_affine"],"attrs":{},"id":0,"op":"LoadDeclaration"},{"args":[0],"attrs":{"axis":"row","fn":"agg.sum"},"id":1,"op":"Reduce"}],"result":1},"elem_affine":{"operations":[{"args":[["batch","row","col","val"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":["row_scale2"],"attrs":{},"id":1,"op":"LoadDeclaration"},{"args":[0,1],"attrs":{"fn":"core.mul"},"id":2,"op":"Map"},{"args":["batch_bias"],"attrs":{},"id":3,"op":"LoadDeclaration"},{"args":[2,3],"attrs":{"fn":"core.add"},"id":4,"op":"Map"}],"result":4},"global_offset_plus":{"operations":[{"args":[["global_offset"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[1.0],"attrs":{},"id":1,"op":"Const"},{"args":[0,1],"attrs":{"fn":"core.add"},"id":2,"op":"Map"}],"result":2},"row_scale2":{"operations":[{"args":[["batch","row","scale"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[2.0],"attrs":{},"id":1,"op":"Const"},{"args":[0,1],"attrs":{"fn":"core.mul"},"id":2,"op":"Map"}],"result":2},"row_sum_affine":{"operations":[{"args":["elem_affine"],"attrs":{},"id":0,"op":"LoadDeclaration"},{"args":[0],"attrs":{"axis":"col","fn":"agg.sum"},"id":1,"op":"Reduce"}],"result":1}},"pack_version":"0.1","plan":{"declarations":{"batch_bias":{"axes":["batch"],"axis_carriers":[{"axis":"batch","via_path":["batch"]}],"inlining_decisions":{"op_1":{"decision":"inline","producer":"global_offset_plus","use_site_axes":[]}},"name":"batch_bias","parameters":[{"kind":"input","path":["batch","mean"]},{"kind":"dependency","source":"global_offset_plus"}],"reduce_plans":[],"result_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"loaddeclaration"}]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":1,"kind":"loaddeclaration"}],"max_depth":1,"root_reduces":[]}},"batch_total_affine":{"axes":["batch"],"axis_carriers":[{"axis":"batch","via_path":["batch"]}],"inlining_decisions":{"op_0":{"decision":"inline","producer":"row_sum_affine","use_site_axes":["batch","row"]}},"name":"batch_total_affine","parameters":[{"kind":"dependency","source":"row_sum_affine"}],"reduce_plans":[{"arg_id":0,"axis":"row","op_id":0,"reducer_fn":"agg.sum","result_depth":1,"via_path":["batch","row"]}],"result_id":1,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":1,"kind":"reduce"}]},{"depth":2,"ops":[{"id":0,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":2,"root_reduces":[]}},"elem_affine":{"axes":["batch","row","col"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]},{"axis":"col","via_path":["batch","row","col"]}],"inlining_decisions":{"op_1":{"decision":"inline","producer":"row_scale2","use_site_axes":["batch","row"]},"op_3":{"decision":"inline","producer":"batch_bias","use_site_axes":["batch"]}},"name":"elem_affine","parameters":[{"kind":"input","path":["batch","row","col","val"]},{"kind":"dependency","source":"row_scale2"},{"kind":"dependency","source":"batch_bias"}],"reduce_plans":[],"result_id":4,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":3,"kind":"loaddeclaration"}]},{"depth":2,"ops":[{"id":1,"kind":"loaddeclaration"}]},{"depth":3,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"},{"id":4,"kind":"map"}]}],"hoisted_scalars":[],"max_depth":3,"root_reduces":[]}},"global_offset_plus":{"axes":[],"axis_carriers":[],"inlining_decisions":{},"name":"global_offset_plus","parameters":[{"kind":"input","path":["global_offset"]}],"reduce_plans":[],"result_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}],"max_depth":0,"root_reduces":[]}},"row_scale2":{"axes":["batch","row"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{},"name":"row_scale2","parameters":[{"kind":"input","path":["batch","row","scale"]}],"reduce_plans":[],"result_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"const"}]},{"depth":1,"ops":[]},{"depth":2,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":1,"kind":"const"}],"max_depth":2,"root_reduces":[]}},"row_sum_affine":{"axes":["batch","row"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{"op_0":{"decision":"inline","producer":"elem_affine","use_site_axes":["batch","row","col"]}},"name":"row_sum_affine","parameters":[{"kind":"dependency","source":"elem_affine"}],"reduce_plans":[{"arg_id":0,"axis":"col","op_id":0,"reducer_fn":"agg.sum","result_depth":2,"via_path":["batch","row","col"]}],"result_id":1,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[]},{"depth":2,"ops":[{"id":1,"kind":"reduce"}]},{"depth":3,"ops":[{"id":0,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":3,"root_reduces":[]}}},"module_spec":{"declarations":["global_offset_plus","batch_bias","row_scale2","elem_affine","row_sum_affine","batch_total_affine"],"inputs":[{"accessor_name":"at_batch","axes":["batch"],"consumes_axes":["batch"],"dtype":"array","path":["batch"]},{"accessor_name":"at_batch_mean","axes":["batch"],"consumes_axes":["batch"],"dtype":"float","path":["batch","mean"]},{"accessor_name":"at_batch_row","axes":["batch","row"],"consumes_axes":["batch","row"],"dtype":"array","path":["batch","row"]},{"accessor_name":"at_batch_row_scale","axes":["batch","row"],"consumes_axes":["batch","row"],"dtype":"float","path":["batch","row","scale"]},{"accessor_name":"at_batch_row_col","axes":["batch","row","col"],"consumes_axes":["batch","row","col"],"dtype":"array","path":["batch","row","col"]},{"accessor_name":"at_batch_row_col_val","axes":["batch","row","col"],"consumes_axes":["batch","row","col"],"dtype":"float","path":["batch","row","col","val"]},{"accessor_name":"at_global_offset","axes":[],"consumes_axes":[],"dtype":"float","path":["global_offset"]}],"modname":"schema_module","version":"0.1"},"version":"0.1"}}