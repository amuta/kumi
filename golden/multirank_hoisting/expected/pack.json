{"bindings":{"ruby":{"kernels":[{"attrs":{},"impl":"->(a, b) { a + b }","kernel_id":"core.add"},{"attrs":{},"impl":"->(a, b) { a * b }","kernel_id":"core.mul"},{"attrs":{"identity":0.0},"impl":"->(a,b) { a + b }","kernel_id":"agg.sum"}]}},"capabilities":{"layout":"nested_array"},"declarations":[{"axes":[],"axis_carriers":[],"inlining_decisions":{},"name":"global_offset_plus","operations":[{"args":[["global_offset"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[1.0],"attrs":{},"id":1,"op":"Const"},{"args":[0,1],"attrs":{"fn":"core.add"},"id":2,"op":"Map"}],"parameters":[{"kind":"input","path":["global_offset"]}],"reduce_plans":[],"result_op_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"const"},{"id":2,"kind":"map"}],"max_depth":0,"root_reduces":[]}},{"axes":["batch"],"axis_carriers":[{"axis":"batch","via_path":["batch"]}],"inlining_decisions":{"op_4":{"decision":"inline","producer":"global_offset_plus","use_site_axes":[]}},"name":"batch_bias","operations":[{"args":[["batch","mean"]],"attrs":{},"id":3,"op":"LoadInput"},{"args":["global_offset_plus"],"attrs":{},"id":4,"op":"LoadDeclaration"},{"args":[3,4],"attrs":{"fn":"core.add"},"id":5,"op":"Map"}],"parameters":[{"kind":"input","path":["batch","mean"]},{"kind":"dependency","source":"global_offset_plus"}],"reduce_plans":[],"result_op_id":5,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":4,"kind":"loaddeclaration"}]},{"depth":1,"ops":[{"id":3,"kind":"loadinput"},{"id":5,"kind":"map"}]}],"hoisted_scalars":[{"id":4,"kind":"loaddeclaration"}],"max_depth":1,"root_reduces":[]}},{"axes":["batch","row"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{},"name":"row_scale2","operations":[{"args":[["batch","row","scale"]],"attrs":{},"id":6,"op":"LoadInput"},{"args":[2.0],"attrs":{},"id":7,"op":"Const"},{"args":[6,7],"attrs":{"fn":"core.mul"},"id":8,"op":"Map"}],"parameters":[{"kind":"input","path":["batch","row","scale"]}],"reduce_plans":[],"result_op_id":8,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":7,"kind":"const"}]},{"depth":1,"ops":[]},{"depth":2,"ops":[{"id":6,"kind":"loadinput"},{"id":8,"kind":"map"}]}],"hoisted_scalars":[{"id":7,"kind":"const"}],"max_depth":2,"root_reduces":[]}},{"axes":["batch","row","col"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"col","via_path":["batch","row","col"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{"op_10":{"decision":"inline","producer":"row_scale2","use_site_axes":["batch","row"]},"op_12":{"decision":"inline","producer":"batch_bias","use_site_axes":["batch"]}},"name":"elem_affine","operations":[{"args":[["batch","row","col","val"]],"attrs":{},"id":9,"op":"LoadInput"},{"args":["row_scale2"],"attrs":{},"id":10,"op":"LoadDeclaration"},{"args":[9,10],"attrs":{"fn":"core.mul"},"id":11,"op":"Map"},{"args":["batch_bias"],"attrs":{},"id":12,"op":"LoadDeclaration"},{"args":[11,12],"attrs":{"fn":"core.add"},"id":13,"op":"Map"}],"parameters":[{"kind":"input","path":["batch","row","col","val"]},{"kind":"dependency","source":"row_scale2"},{"kind":"dependency","source":"batch_bias"}],"reduce_plans":[],"result_op_id":13,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":12,"kind":"loaddeclaration"}]},{"depth":2,"ops":[{"id":10,"kind":"loaddeclaration"}]},{"depth":3,"ops":[{"id":9,"kind":"loadinput"},{"id":11,"kind":"map"},{"id":13,"kind":"map"}]}],"hoisted_scalars":[],"max_depth":3,"root_reduces":[]}},{"axes":["batch","row"],"axis_carriers":[{"axis":"batch","via_path":["batch"]},{"axis":"row","via_path":["batch","row"]}],"inlining_decisions":{"op_14":{"decision":"inline","producer":"elem_affine","use_site_axes":["batch","row","col"]}},"name":"row_sum_affine","operations":[{"args":["elem_affine"],"attrs":{},"id":14,"op":"LoadDeclaration"},{"args":[14],"attrs":{"axis":"col","fn":"agg.sum"},"id":15,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"elem_affine"}],"reduce_plans":[{"arg_id":14,"axis":"col","bind_depth":2,"contrib_depth":3,"nested":false,"op_id":15,"reducer_fn":"agg.sum","reset_depth":2,"result_depth":2,"via_path":["batch","row","col"]}],"result_op_id":15,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[]},{"depth":2,"ops":[{"id":15,"kind":"reduce"}]},{"depth":3,"ops":[{"id":14,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":3,"root_reduces":[]}},{"axes":["batch"],"axis_carriers":[{"axis":"batch","via_path":["batch"]}],"inlining_decisions":{"op_16":{"decision":"call","producer":"row_sum_affine","use_site_axes":["batch","row"]}},"name":"batch_total_affine","operations":[{"args":["row_sum_affine"],"attrs":{},"id":16,"op":"LoadDeclaration"},{"args":[16],"attrs":{"axis":"row","fn":"agg.sum"},"id":17,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"row_sum_affine"}],"reduce_plans":[{"arg_id":16,"axis":"row","bind_depth":1,"contrib_depth":2,"nested":false,"op_id":17,"reducer_fn":"agg.sum","reset_depth":1,"result_depth":1,"via_path":["batch","row"]}],"result_op_id":17,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":17,"kind":"reduce"}]},{"depth":2,"ops":[{"id":16,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":2,"root_reduces":[]}}],"hashes":{"bindings":"3348fb476948c6dbfbe8fb9cbb7885960f977aa579780d139c16a92351c2d49f","declarations":"c70bbd4a656eddc8b941749de0127730b4752836473e40504ab492c67fb7b826","inputs":"dc52d1036aaceb1197706f9d0209700eb1b0a4cacb7264f6e541fb66fc603f7e"},"inputs":[{"accessor_name":"batch","axes":["batch"],"navigation_steps":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]}],"dtype":"array","leaf_nav":[],"name":"batch","path_fqn":"batch","terminal":{"dtype":"array","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_mean","axes":["batch"],"navigation_steps":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]}],"dtype":"float","leaf_nav":[{"key":"mean","kind":"field_leaf"}],"name":"batch.mean","path_fqn":"batch.mean","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row","axes":["batch","row"],"navigation_steps":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]}],"dtype":"array","leaf_nav":[],"name":"batch.row","path_fqn":"batch.row","terminal":{"dtype":"array","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row_scale","axes":["batch","row"],"navigation_steps":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]}],"dtype":"float","leaf_nav":[{"key":"scale","kind":"field_leaf"}],"name":"batch.row.scale","path_fqn":"batch.row.scale","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row_col","axes":["batch","row","col"],"navigation_steps":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]},{"axes":"col","key":"col","kind":"array_field","loop_idx":2,"path":["batch","row","col"]}],"dtype":"array","leaf_nav":[],"name":"batch.row.col","path_fqn":"batch.row.col","terminal":{"dtype":"array","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"batch_row_col_val","axes":["batch","row","col"],"navigation_steps":[{"axes":"batch","key":"batch","kind":"array_field","loop_idx":0,"path":["batch"]},{"axes":"row","key":"row","kind":"array_field","loop_idx":1,"path":["batch","row"]},{"axes":"col","key":"col","kind":"array_field","loop_idx":2,"path":["batch","row","col"]}],"dtype":"float","leaf_nav":[{"key":"val","kind":"field_leaf"}],"name":"batch.row.col.val","path_fqn":"batch.row.col.val","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"global_offset","axes":[],"navigation_steps":[],"dtype":"float","leaf_nav":[{"key":"global_offset","kind":"field_leaf"}],"name":"global_offset","path_fqn":"global_offset","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}}],"module_id":"schema_module","pack_version":"0.1"}