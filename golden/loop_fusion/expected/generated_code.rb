# Autogenerated by Kumi Codegen
module Kumi::Compiled::KUMI_9595fa0250d2550932f13e76cb0a2bb9567c6c3fd7688933697f5bc47746f49d
  def self.from(input_data = nil)
    instance = Object.new
    instance.extend(self)
    instance.instance_variable_set(:@input, input_data)
    instance
  end

  def self.__kumi_executable__
    instance = Object.new
    instance.extend(self)
    instance
  end

  def update(input_data)
    @input = @input.merge(input_data)
    self
  end

  def [](name)
    case name
    when :total_payroll then _total_payroll
    when :manager_count then _manager_count
    when :department_summary then _department_summary
    else raise KeyError, "Unknown declaration"
    end
  end

  def _total_payroll(input = @input)
    out = []
    t1 = input["departments"] || input[:departments]
    t1.each_with_index do |departments_el_2, _departments_i_3|
      acc_4 = 0
      t5 = departments_el_2["employees"] || departments_el_2[:employees]
      t5.each_with_index do |employees_el_6, _employees_i_7|
        t8 = employees_el_6["salary"] || employees_el_6[:salary]
        acc_4 += t8
      end
      t9 = acc_4
      out << t9
    end
    out
  end

  def _manager_count(input = @input)
    out = []
    t10 = input["departments"] || input[:departments]
    t10.each_with_index do |departments_el_11, _departments_i_12|
      acc_13 = 0
      t14 = departments_el_11["employees"] || departments_el_11[:employees]
      t14.each_with_index do |employees_el_15, _employees_i_16|
        t17 = employees_el_15["role"] || employees_el_15[:role]
        t19 = t17 == "manager"
        t22 = t19 ? 1 : 0
        acc_13 += t22
      end
      t23 = acc_13
      out << t23
    end
    out
  end

  def _department_summary(input = @input)
    out = []
    t24 = input["departments"] || input[:departments]
    t24.each_with_index do |departments_el_25, _departments_i_26|
      t27 = departments_el_25["name"] || departments_el_25[:name]
      acc33 = 0
      t34 = departments_el_25["employees"] || departments_el_25[:employees]
      acc39 = 0
      t34.each_with_index do |employees_el_6, _employees_i_7|
        t35 = employees_el_6["salary"] || employees_el_6[:salary]
        acc33 += t35
        t41 = employees_el_6["role"] || employees_el_6[:role]
        t43 = t41 == "manager"
        t46 = t43 ? 1 : 0
        acc39 += t46
      end
      t36 = acc33
      t47 = acc39
      t30 = {
        "name" => t27,
        "total_payroll" => t36,
        "manager_count" => t47
      }
      out << t30
    end
    out
  end
end
