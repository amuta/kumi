{
  "$schema": "https://kumi.dev/schema/irv2-core.schema.json",
  "version": "2.0",
  "module": "schema_module",
  "declarations": {
    "org_name": {
      "name": "org_name",
      "parameters": [{"kind":"input","path":["organization","name"]}],
      "operations": [{"id":0,"op":"LoadInput","args":[["organization","name"]],"stamp":{"dtype":"string","axes":[]}}],
      "result": 0
    },
    "region_names": {
      "name": "region_names",
      "parameters": [{"kind":"input","path":["organization","regions","region_name"]}],
      "operations": [
        {
          "id": 0,
          "op": "LoadInput",
          "args": [["organization","regions","region_name"]],
          "stamp": {"dtype":"string","axes":["regions"]}
        }
      ],
      "result": 0
    },
    "hq_cities": {
      "name": "hq_cities",
      "parameters": [{"kind":"input","path":["organization","regions","headquarters","city"]}],
      "operations": [
        {
          "id": 0,
          "op": "LoadInput",
          "args": [["organization","regions","headquarters","city"]],
          "stamp": {"dtype":"string","axes":["regions"]}
        }
      ],
      "result": 0
    },
    "building_names": {
      "name": "building_names",
      "parameters": [{"kind":"input","path":["organization","regions","headquarters","buildings","building_name"]}],
      "operations": [
        {
          "id": 0,
          "op": "LoadInput",
          "args": [["organization","regions","headquarters","buildings","building_name"]],
          "stamp": {"dtype":"string","axes":["regions","buildings"]}
        }
      ],
      "result": 0
    },
    "facility_types": {
      "name": "facility_types",
      "parameters": [{"kind":"input","path":["organization","regions","headquarters","buildings","facilities","facility_type"]}],
      "operations": [
        {
          "id": 0,
          "op": "LoadInput",
          "args": [["organization","regions","headquarters","buildings","facilities","facility_type"]],
          "stamp": {"dtype":"string","axes":["regions","buildings"]}
        }
      ],
      "result": 0
    },
    "capacities": {
      "name": "capacities",
      "parameters": [{"kind":"input","path":["organization","regions","headquarters","buildings","facilities","capacity"]}],
      "operations": [
        {
          "id": 0,
          "op": "LoadInput",
          "args": [["organization","regions","headquarters","buildings","facilities","capacity"]],
          "stamp": {"dtype":"integer","axes":["regions","buildings"]}
        }
      ],
      "result": 0
    },
    "utilization_rates": {
      "name": "utilization_rates",
      "parameters": [{"kind":"input","path":["organization","regions","headquarters","buildings","facilities","utilization_rate"]}],
      "operations": [
        {
          "id": 0,
          "op": "LoadInput",
          "args": [["organization","regions","headquarters","buildings","facilities","utilization_rate"]],
          "stamp": {"dtype":"float","axes":["regions","buildings"]}
        }
      ],
      "result": 0
    },
    "large_organization": {
      "name": "large_organization",
      "parameters": [{"kind":"input","path":["organization","regions"]}],
      "operations": [
        {"id":0,"op":"LoadInput","args":[["organization","regions"]],"stamp":{"dtype":"array","axes":["regions"]}},
        {"id":1,"op":"Map","args":[0],"stamp":{"dtype":"integer","axes":["regions"]},"attrs":{"fn":"core.length"}},
        {"id":2,"op":"Const","args":[1],"stamp":{"dtype":"integer","axes":[]}},
        {"id":3,"op":"AlignTo","args":[2],"stamp":{"dtype":"integer","axes":["regions"]},"attrs":{"target_axes":["regions"]}},
        {"id":4,"op":"Map","args":[1,3],"stamp":{"dtype":"boolean","axes":["regions"]},"attrs":{"fn":"core.gt"}}
      ],
      "result": 4
    },
    "org_classification": {
      "name": "org_classification",
      "parameters": [{"kind":"dependency","source":"large_organization"}],
      "operations": [
        {"id":0,"op":"LoadDeclaration","args":["large_organization"],"stamp":{"dtype":"boolean","axes":["regions"]}},
        {"id":1,"op":"Const","args":["Enterprise"],"stamp":{"dtype":"string","axes":[]}},
        {"id":2,"op":"Const","args":["Standard"],"stamp":{"dtype":"string","axes":[]}},
        {"id":3,"op":"AlignTo","args":[1],"stamp":{"dtype":"string","axes":["regions"]},"attrs":{"target_axes":["regions"]}},
        {"id":4,"op":"AlignTo","args":[2],"stamp":{"dtype":"string","axes":["regions"]},"attrs":{"target_axes":["regions"]}},
        {"id":5,"op":"Map","args":[0,3,4],"stamp":{"dtype":"string","axes":["regions"]},"attrs":{"fn":"core.select"}}
      ],
      "result": 5
    },
    "total_capacity": {
      "name": "total_capacity",
      "parameters": [{"kind":"input","path":["organization","regions","headquarters","buildings","facilities","capacity"]}],
      "operations": [
        {
          "id": 0,
          "op": "LoadInput",
          "args": [["organization","regions","headquarters","buildings","facilities","capacity"]],
          "stamp": {"dtype":"integer","axes":["regions","buildings"]}
        },
        {
          "id": 1,
          "op": "Reduce",
          "args": [0],
          "stamp": {"dtype":"integer","axes":["regions"]},
          "attrs": {"fn":"agg.sum","axis":"buildings"}
        }
      ],
      "result": 1
    }
  },
  "analysis": {
    "defaults": {"key_policy":"indifferent","on_missing":"error"},
    "inputs": [
      {
        "path": ["organization"],
        "axes": [],
        "dtype": "hash",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [{"kind":"scalar_leaf","key":"organization"}]
      },
      {
        "path": ["organization","name"],
        "axes": [],
        "dtype": "string",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [{"kind":"scalar_leaf","key":"organization"},{"kind":"scalar_leaf","key":"name"}]
      },
      {
        "path": ["organization","regions"],
        "axes": ["regions"],
        "dtype": "array",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [{"kind":"scalar_leaf","key":"organization"},{"kind":"array_field","key":"regions","axis":"regions"}]
      },
      {
        "path": ["organization","regions","region_name"],
        "axes": ["regions"],
        "dtype": "string",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"scalar_leaf","key":"region_name"}
        ]
      },
      {
        "path": ["organization","regions","headquarters"],
        "axes": ["regions"],
        "dtype": "hash",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"scalar_leaf","key":"headquarters"}
        ]
      },
      {
        "path": ["organization","regions","headquarters","city"],
        "axes": ["regions"],
        "dtype": "string",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"scalar_leaf","key":"headquarters"},
          {"kind":"scalar_leaf","key":"city"}
        ]
      },
      {
        "path": ["organization","regions","headquarters","buildings"],
        "axes": ["regions","buildings"],
        "dtype": "array",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"array_element","alias":"headquarters","axis":"buildings"},
          {"kind":"scalar_leaf","key":"buildings"}
        ]
      },
      {
        "path": ["organization","regions","headquarters","buildings","building_name"],
        "axes": ["regions","buildings"],
        "dtype": "string",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"array_element","alias":"headquarters","axis":"buildings"},
          {"kind":"scalar_leaf","key":"buildings"},
          {"kind":"scalar_leaf","key":"building_name"}
        ]
      },
      {
        "path": ["organization","regions","headquarters","buildings","facilities"],
        "axes": ["regions","buildings"],
        "dtype": "hash",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"array_element","alias":"headquarters","axis":"buildings"},
          {"kind":"scalar_leaf","key":"buildings"},
          {"kind":"scalar_leaf","key":"facilities"}
        ]
      },
      {
        "path": ["organization","regions","headquarters","buildings","facilities","facility_type"],
        "axes": ["regions","buildings"],
        "dtype": "string",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"array_element","alias":"headquarters","axis":"buildings"},
          {"kind":"scalar_leaf","key":"buildings"},
          {"kind":"scalar_leaf","key":"facilities"},
          {"kind":"scalar_leaf","key":"facility_type"}
        ]
      },
      {
        "path": ["organization","regions","headquarters","buildings","facilities","capacity"],
        "axes": ["regions","buildings"],
        "dtype": "integer",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"array_element","alias":"headquarters","axis":"buildings"},
          {"kind":"scalar_leaf","key":"buildings"},
          {"kind":"scalar_leaf","key":"facilities"},
          {"kind":"scalar_leaf","key":"capacity"}
        ]
      },
      {
        "path": ["organization","regions","headquarters","buildings","facilities","utilization_rate"],
        "axes": ["regions","buildings"],
        "dtype": "float",
        "key_policy": "indifferent",
        "on_missing": "error",
        "chain": [
          {"kind":"scalar_leaf","key":"organization"},
          {"kind":"array_field","key":"regions","axis":"regions"},
          {"kind":"array_element","alias":"headquarters","axis":"buildings"},
          {"kind":"scalar_leaf","key":"buildings"},
          {"kind":"scalar_leaf","key":"facilities"},
          {"kind":"scalar_leaf","key":"utilization_rate"}
        ]
      }
    ]
  }
}