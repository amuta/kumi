(NAST
  (VALUE users
    (Hash
    (Pair name 
      (InputRef [:users, :user, :name])
    )
    (Pair state 
      (InputRef [:users, :user, :state])
    )
  )
  )
  (TRAIT is_john
    (Call :"core.eq"
    (InputRef [:users, :user, :name])
    (Const "John")
  )
  )
  (VALUE john_user
    (Call :select
    (Ref is_john)
    (Ref users)
    (Const "NOT_JOHN")
  )
  )
)