(NAST
  (VALUE total_payroll
    (Call :"agg.sum"
    (InputRef [:departments, :dept, :employees, :emp, :salary])
  )
  )
  (VALUE payroll_tax
    (Call :"core.mul"
    (Ref total_payroll)
    (Const 0.15)
  )
  )
  (VALUE manager_count
    (Call :sum
    (Call :__select__
      (Call :eq
        (InputRef [:departments, :dept, :employees, :emp, :role])
        (Const "manager")
      )
      (Const 1)
      (Const 0)
    )
  )
  )
  (VALUE department_summary
    (Hash
    (Pair name 
      (InputRef [:departments, :dept, :name])
    )
    (Pair payroll 
      (Ref total_payroll)
    )
    (Pair tax 
      (Ref payroll_tax)
    )
    (Pair managers 
      (Ref manager_count)
    )
  )
  )
)