(Root
  inputs: [
    (InputDeclaration :departments :array
      [
        (InputDeclaration :dept :hash
          [
            (InputDeclaration :name :string)
            (InputDeclaration :employees :array
              [
                (InputDeclaration :emp :hash
                  [
                    (InputDeclaration :salary :integer)
                    (InputDeclaration :role :string)
                  ]
                )
              ]
            )
          ]
        )
      ]
    )
  ]
  values: [
    (ValueDeclaration :total_payroll
      (CallExpression :sum
        (InputElementReference departments.dept.employees.emp.salary)
      )
    )
    (ValueDeclaration :payroll_tax
      (CallExpression :multiply
        (DeclarationReference :total_payroll)
        (Literal 0.15)
      )
    )
    (ValueDeclaration :manager_count
      (CallExpression :count_if
        (InputElementReference departments.dept.employees.emp.role)
        (Literal "manager")
      )
    )
    (ValueDeclaration :department_summary
      (HashExpression
        ((Literal :name) (InputElementReference departments.dept.name))
        ((Literal :payroll) (DeclarationReference :total_payroll))
        ((Literal :tax) (DeclarationReference :payroll_tax))
        ((Literal :managers) (DeclarationReference :manager_count))
      )
    )
  ]
  traits: []
)