{"bindings":{"ruby":{"kernels":[{"impl":"->(a, b) { a * b }","kernel_id":"core.mul"},{"impl":"->(a, b) { a - b }","kernel_id":"core.sub"},{"impl":"->(a, b) { a > b }","kernel_id":"core.gt"},{"impl":"->(a,b) { a + b }","kernel_id":"agg.sum"}]}},"capabilities":{"layout":"nested_array"},"declarations":[{"axes":[],"axis_carriers":[],"inlining_decisions":{"op_0":{"decision":"inline","producer":"items_subtotal","use_site_axes":["items"]}},"name":"cart_total","operations":[{"args":["items_subtotal"],"attrs":{},"id":0,"op":"LoadDeclaration"},{"args":[0],"attrs":{"axis":"items","fn":"agg.sum"},"id":1,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"items_subtotal"}],"reduce_plans":[{"arg_id":0,"axis":"items","op_id":1,"reducer_fn":"agg.sum","result_depth":0,"via_path":["items"]}],"result_op_id":1,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"reduce"}]},{"depth":1,"ops":[{"id":0,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[{"id":1,"kind":"reduce"}]}},{"axes":[],"axis_carriers":[],"inlining_decisions":{"op_0":{"decision":"inline","producer":"items_effective","use_site_axes":["items"]}},"name":"cart_total_effective","operations":[{"args":["items_effective"],"attrs":{},"id":0,"op":"LoadDeclaration"},{"args":[0],"attrs":{"axis":"items","fn":"agg.sum"},"id":1,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"items_effective"}],"reduce_plans":[{"arg_id":0,"axis":"items","op_id":1,"reducer_fn":"agg.sum","result_depth":0,"via_path":["items"]}],"result_op_id":1,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"reduce"}]},{"depth":1,"ops":[{"id":0,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[{"id":1,"kind":"reduce"}]}},{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{},"name":"items_discounted","operations":[{"args":[["items","price"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[1.0],"attrs":{},"id":1,"op":"Const"},{"args":[["discount"]],"attrs":{},"id":2,"op":"LoadInput"},{"args":[1,2],"attrs":{"fn":"core.sub"},"id":3,"op":"Map"},{"args":[0,3],"attrs":{"fn":"core.mul"},"id":4,"op":"Map"}],"parameters":[{"kind":"input","path":["items","price"]},{"kind":"input","path":["discount"]}],"reduce_plans":[],"result_op_id":4,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"const"},{"id":2,"kind":"loadinput"},{"id":3,"kind":"map"}]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":4,"kind":"map"}]}],"hoisted_scalars":[{"id":1,"kind":"const"},{"id":2,"kind":"loadinput"},{"id":3,"kind":"map"}],"max_depth":1,"root_reduces":[]}},{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{"op_0":{"decision":"inline","producer":"items_is_big","use_site_axes":["items"]},"op_1":{"decision":"inline","producer":"items_subtotal","use_site_axes":["items"]}},"name":"items_effective","operations":[{"args":["items_is_big"],"attrs":{},"id":0,"op":"LoadDeclaration"},{"args":["items_subtotal"],"attrs":{},"id":1,"op":"LoadDeclaration"},{"args":[0.9],"attrs":{},"id":2,"op":"Const"},{"args":[1,2],"attrs":{"fn":"core.mul"},"id":3,"op":"Map"},{"args":[0,3,1],"attrs":{},"id":5,"op":"Select"}],"parameters":[{"kind":"dependency","source":"items_is_big"},{"kind":"dependency","source":"items_subtotal"}],"reduce_plans":[],"result_op_id":5,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":2,"kind":"const"}]},{"depth":1,"ops":[{"id":0,"kind":"loaddeclaration"},{"id":1,"kind":"loaddeclaration"},{"id":3,"kind":"map"},{"id":5,"kind":"select"}]}],"hoisted_scalars":[{"id":2,"kind":"const"}],"max_depth":1,"root_reduces":[]}},{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{},"name":"items_is_big","operations":[{"args":[["items","price"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[100.0],"attrs":{},"id":1,"op":"Const"},{"args":[0,1],"attrs":{"fn":"core.gt"},"id":2,"op":"Map"}],"parameters":[{"kind":"input","path":["items","price"]}],"reduce_plans":[],"result_op_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"const"}]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[{"id":1,"kind":"const"}],"max_depth":1,"root_reduces":[]}},{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{},"name":"items_subtotal","operations":[{"args":[["items","price"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[["items","qty"]],"attrs":{},"id":1,"op":"LoadInput"},{"args":[0,1],"attrs":{"fn":"core.mul"},"id":2,"op":"Map"}],"parameters":[{"kind":"input","path":["items","price"]},{"kind":"input","path":["items","qty"]}],"reduce_plans":[],"result_op_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"loadinput"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[]}},{"axes":[],"axis_carriers":[],"inlining_decisions":{},"name":"total_qty","operations":[{"args":[["items","qty"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[0],"attrs":{"axis":"items","fn":"agg.sum"},"id":1,"op":"Reduce"}],"parameters":[{"kind":"input","path":["items","qty"]}],"reduce_plans":[{"arg_id":0,"axis":"items","op_id":1,"reducer_fn":"agg.sum","result_depth":0,"via_path":["items"]}],"result_op_id":1,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":1,"kind":"reduce"}]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[{"id":1,"kind":"reduce"}]}}],"hashes":{"bindings":"54f52b116ade892602e3e97a9b105f6b16ecaf4598a5939fcfbfa49b22d54aba","declarations":"0e7bc71e52e6c55580b9efb292bf05f06c19fb40251e6569ed7663e4bb3eca6a","inputs":"71094081f55c7aa2aae6462fdc0153ab997138d549724a490e9babc81d1764b4"},"inputs":[{"accessor_name":"items","axes":["items"],"chain":[{"axis":"items","key":"items","kind":"array_field"}],"dtype":"array","name":"items"},{"accessor_name":"items_price","axes":["items"],"chain":[{"axis":"items","key":"items","kind":"array_field"},{"key":"price","kind":"field_leaf"}],"dtype":"float","name":"items.price"},{"accessor_name":"items_qty","axes":["items"],"chain":[{"axis":"items","key":"items","kind":"array_field"},{"key":"qty","kind":"field_leaf"}],"dtype":"integer","name":"items.qty"},{"accessor_name":"discount","axes":[],"chain":[{"key":"discount","kind":"field_leaf"}],"dtype":"float","name":"discount"}],"module_id":"schema_module","pack_version":"0.1"}