{"bindings":{"ruby":{"kernels":[{"attrs":{},"impl":"->(a, b) { a * b }","kernel_id":"core.mul"},{"attrs":{},"impl":"->(a, b) { a - b }","kernel_id":"core.sub"},{"attrs":{},"impl":"->(a, b) { a > b }","kernel_id":"core.gt"},{"attrs":{"identity":0.0},"impl":"->(a,b) { a + b }","kernel_id":"agg.sum"}]}},"capabilities":{"layout":"nested_array"},"declarations":[{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{},"name":"items_subtotal","operations":[{"args":[["items","price"]],"attrs":{},"id":0,"op":"LoadInput"},{"args":[["items","qty"]],"attrs":{},"id":1,"op":"LoadInput"},{"args":[0,1],"attrs":{"fn":"core.mul"},"id":2,"op":"Map"}],"parameters":[{"kind":"input","path":["items","price"]},{"kind":"input","path":["items","qty"]}],"reduce_plans":[],"result_op_id":2,"site_schedule":{"by_depth":[{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"loadinput"},{"id":2,"kind":"map"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[]}},{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{},"name":"items_discounted","operations":[{"args":[["items","price"]],"attrs":{},"id":3,"op":"LoadInput"},{"args":[1.0],"attrs":{},"id":4,"op":"Const"},{"args":[["discount"]],"attrs":{},"id":5,"op":"LoadInput"},{"args":[4,5],"attrs":{"fn":"core.sub"},"id":6,"op":"Map"},{"args":[3,6],"attrs":{"fn":"core.mul"},"id":7,"op":"Map"}],"parameters":[{"kind":"input","path":["items","price"]},{"kind":"input","path":["discount"]}],"reduce_plans":[],"result_op_id":7,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":4,"kind":"const"},{"id":5,"kind":"loadinput"},{"id":6,"kind":"map"}]},{"depth":1,"ops":[{"id":3,"kind":"loadinput"},{"id":7,"kind":"map"}]}],"hoisted_scalars":[{"id":4,"kind":"const"},{"id":5,"kind":"loadinput"},{"id":6,"kind":"map"}],"max_depth":1,"root_reduces":[]}},{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{},"name":"items_is_big","operations":[{"args":[["items","price"]],"attrs":{},"id":8,"op":"LoadInput"},{"args":[100.0],"attrs":{},"id":9,"op":"Const"},{"args":[8,9],"attrs":{"fn":"core.gt"},"id":10,"op":"Map"}],"parameters":[{"kind":"input","path":["items","price"]}],"reduce_plans":[],"result_op_id":10,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":9,"kind":"const"}]},{"depth":1,"ops":[{"id":8,"kind":"loadinput"},{"id":10,"kind":"map"}]}],"hoisted_scalars":[{"id":9,"kind":"const"}],"max_depth":1,"root_reduces":[]}},{"axes":["items"],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{"op_11":{"decision":"inline","producer":"items_is_big","use_site_axes":["items"]},"op_12":{"decision":"inline","producer":"items_subtotal","use_site_axes":["items"]},"op_15":{"decision":"inline","producer":"items_subtotal","use_site_axes":["items"]}},"name":"items_effective","operations":[{"args":["items_is_big"],"attrs":{},"id":11,"op":"LoadDeclaration"},{"args":["items_subtotal"],"attrs":{},"id":12,"op":"LoadDeclaration"},{"args":[0.9],"attrs":{},"id":13,"op":"Const"},{"args":[12,13],"attrs":{"fn":"core.mul"},"id":14,"op":"Map"},{"args":["items_subtotal"],"attrs":{},"id":15,"op":"LoadDeclaration"},{"args":[11,14,15],"attrs":{},"id":16,"op":"Select"}],"parameters":[{"kind":"dependency","source":"items_is_big"},{"kind":"dependency","source":"items_subtotal"}],"reduce_plans":[],"result_op_id":16,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":13,"kind":"const"}]},{"depth":1,"ops":[{"id":11,"kind":"loaddeclaration"},{"id":12,"kind":"loaddeclaration"},{"id":14,"kind":"map"},{"id":15,"kind":"loaddeclaration"},{"id":16,"kind":"select"}]}],"hoisted_scalars":[{"id":13,"kind":"const"}],"max_depth":1,"root_reduces":[]}},{"axes":[],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{},"name":"total_qty","operations":[{"args":[["items","qty"]],"attrs":{},"id":17,"op":"LoadInput"},{"args":[17],"attrs":{"axis":"items","fn":"agg.sum"},"id":18,"op":"Reduce"}],"parameters":[{"kind":"input","path":["items","qty"]}],"reduce_plans":[{"arg_id":17,"axis":"items","bind_depth":-1,"contrib_depth":1,"nested":false,"op_id":18,"reducer_fn":"agg.sum","reset_depth":-1,"result_depth":0,"via_path":["items"]}],"result_op_id":18,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":18,"kind":"reduce"}]},{"depth":1,"ops":[{"id":17,"kind":"loadinput"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[{"id":18,"kind":"reduce"}]}},{"axes":[],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{"op_19":{"decision":"inline","producer":"items_subtotal","use_site_axes":["items"]}},"name":"cart_total","operations":[{"args":["items_subtotal"],"attrs":{},"id":19,"op":"LoadDeclaration"},{"args":[19],"attrs":{"axis":"items","fn":"agg.sum"},"id":20,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"items_subtotal"}],"reduce_plans":[{"arg_id":19,"axis":"items","bind_depth":-1,"contrib_depth":1,"nested":false,"op_id":20,"reducer_fn":"agg.sum","reset_depth":-1,"result_depth":0,"via_path":["items"]}],"result_op_id":20,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":20,"kind":"reduce"}]},{"depth":1,"ops":[{"id":19,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[{"id":20,"kind":"reduce"}]}},{"axes":[],"axis_carriers":[{"axis":"items","via_path":["items"]}],"inlining_decisions":{"op_21":{"decision":"inline","producer":"items_effective","use_site_axes":["items"]}},"name":"cart_total_effective","operations":[{"args":["items_effective"],"attrs":{},"id":21,"op":"LoadDeclaration"},{"args":[21],"attrs":{"axis":"items","fn":"agg.sum"},"id":22,"op":"Reduce"}],"parameters":[{"kind":"dependency","source":"items_effective"}],"reduce_plans":[{"arg_id":21,"axis":"items","bind_depth":-1,"contrib_depth":1,"nested":false,"op_id":22,"reducer_fn":"agg.sum","reset_depth":-1,"result_depth":0,"via_path":["items"]}],"result_op_id":22,"site_schedule":{"by_depth":[{"depth":0,"ops":[{"id":22,"kind":"reduce"}]},{"depth":1,"ops":[{"id":21,"kind":"loaddeclaration"}]}],"hoisted_scalars":[],"max_depth":1,"root_reduces":[{"id":22,"kind":"reduce"}]}}],"hashes":{"bindings":"296637f7392a2d64b6e45cd73dc400e92cd93080023d5b1719bbd5225a52fabd","declarations":"0065cea481626dd245da306711ccd3d7dc0221e2e08c9411b0f2df2392eec532","inputs":"b9e4074d49d7ca69e75cbca2aecdf8486b7c7561aa94589571137289855e33bf"},"inputs":[{"accessor_name":"items","axes":["items"],"navigation_steps":[{"axes":"items","key":"items","kind":"array_field","loop_idx":0,"path":["items"]}],"dtype":"array","leaf_nav":[],"name":"items","path_fqn":"items","terminal":{"dtype":"array","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"items_price","axes":["items"],"navigation_steps":[{"axes":"items","key":"items","kind":"array_field","loop_idx":0,"path":["items"]}],"dtype":"float","leaf_nav":[{"key":"price","kind":"field_leaf"}],"name":"items.price","path_fqn":"items.price","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"items_qty","axes":["items"],"navigation_steps":[{"axes":"items","key":"items","kind":"array_field","loop_idx":0,"path":["items"]}],"dtype":"integer","leaf_nav":[{"key":"qty","kind":"field_leaf"}],"name":"items.qty","path_fqn":"items.qty","terminal":{"dtype":"integer","key_policy":"indifferent","kind":"none","on_missing":"error"}},{"accessor_name":"discount","axes":[],"navigation_steps":[],"dtype":"float","leaf_nav":[{"key":"discount","kind":"field_leaf"}],"name":"discount","path_fqn":"discount","terminal":{"dtype":"float","key_policy":"indifferent","kind":"none","on_missing":"error"}}],"module_id":"schema_module","pack_version":"0.1"}