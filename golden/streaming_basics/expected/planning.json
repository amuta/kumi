{
  "version": "0.1",
  "module_spec": {
    "version": "0.1",
    "modname": "schema_module",
    "declarations": ["items_subtotal","items_discounted","items_is_big","items_effective","total_qty","cart_total","cart_total_effective"],
    "inputs": [
      {"path":["items"],"axes":["items"],"dtype":"array","consumes_axes":["items"],"accessor_name":"at_items"},
      {"path":["items","price"],"axes":["items"],"dtype":"float","consumes_axes":["items"],"accessor_name":"at_items_price"},
      {"path":["items","qty"],"axes":["items"],"dtype":"integer","consumes_axes":["items"],"accessor_name":"at_items_qty"},
      {"path":["discount"],"axes":[],"dtype":"float","consumes_axes":[],"accessor_name":"at_discount"}
    ]
  },
  "declarations": {
    "items_subtotal": {
      "name": "items_subtotal",
      "axes": ["items"],
      "parameters": [{"kind":"input","path":["items","price"]},{"kind":"input","path":["items","qty"]}],
      "result_id": 2,
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [],
        "root_reduces": [],
        "by_depth": [{"depth":0,"ops":[]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":1,"kind":"loadinput"},{"id":2,"kind":"map"}]}]
      },
      "axis_carriers": [{"axis":"items","via_path":["items"]}],
      "reduce_plans": [],
      "inlining_decisions": {}
    },
    "items_discounted": {
      "name": "items_discounted",
      "axes": ["items"],
      "parameters": [{"kind":"input","path":["items","price"]},{"kind":"input","path":["discount"]}],
      "result_id": 4,
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [{"id":1,"kind":"const"},{"id":2,"kind":"loadinput"},{"id":3,"kind":"map"}],
        "root_reduces": [],
        "by_depth": [
          {"depth":0,"ops":[{"id":1,"kind":"const"},{"id":2,"kind":"loadinput"},{"id":3,"kind":"map"}]},
          {"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":4,"kind":"map"}]}
        ]
      },
      "axis_carriers": [{"axis":"items","via_path":["items"]}],
      "reduce_plans": [],
      "inlining_decisions": {}
    },
    "items_is_big": {
      "name": "items_is_big",
      "axes": ["items"],
      "parameters": [{"kind":"input","path":["items","price"]}],
      "result_id": 2,
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [{"id":1,"kind":"const"}],
        "root_reduces": [],
        "by_depth": [{"depth":0,"ops":[{"id":1,"kind":"const"}]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"},{"id":2,"kind":"map"}]}]
      },
      "axis_carriers": [{"axis":"items","via_path":["items"]}],
      "reduce_plans": [],
      "inlining_decisions": {}
    },
    "items_effective": {
      "name": "items_effective",
      "axes": ["items"],
      "parameters": [{"kind":"dependency","source":"items_is_big"},{"kind":"dependency","source":"items_subtotal"}],
      "result_id": 5,
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [{"id":2,"kind":"const"}],
        "root_reduces": [],
        "by_depth": [
          {"depth":0,"ops":[{"id":2,"kind":"const"}]},
          {
            "depth": 1,
            "ops": [{"id":0,"kind":"loaddeclaration"},{"id":1,"kind":"loaddeclaration"},{"id":3,"kind":"map"},{"id":5,"kind":"select"}]
          }
        ]
      },
      "axis_carriers": [{"axis":"items","via_path":["items"]}],
      "reduce_plans": [],
      "inlining_decisions": {
        "op_0": {"producer":"items_is_big","decision":"inline","use_site_axes":["items"]},
        "op_1": {"producer":"items_subtotal","decision":"inline","use_site_axes":["items"]}
      }
    },
    "total_qty": {
      "name": "total_qty",
      "axes": [],
      "parameters": [{"kind":"input","path":["items","qty"]}],
      "result_id": 1,
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [],
        "root_reduces": [{"id":1,"kind":"reduce"}],
        "by_depth": [{"depth":0,"ops":[{"id":1,"kind":"reduce"}]},{"depth":1,"ops":[{"id":0,"kind":"loadinput"}]}]
      },
      "axis_carriers": [],
      "reduce_plans": [{"op_id":0,"axis":"items","result_depth":0,"arg_id":0,"reducer_fn":"agg.sum","via_path":["items"]}],
      "inlining_decisions": {}
    },
    "cart_total": {
      "name": "cart_total",
      "axes": [],
      "parameters": [{"kind":"dependency","source":"items_subtotal"}],
      "result_id": 1,
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [],
        "root_reduces": [{"id":1,"kind":"reduce"}],
        "by_depth": [{"depth":0,"ops":[{"id":1,"kind":"reduce"}]},{"depth":1,"ops":[{"id":0,"kind":"loaddeclaration"}]}]
      },
      "axis_carriers": [],
      "reduce_plans": [{"op_id":0,"axis":"items","result_depth":0,"arg_id":0,"reducer_fn":"agg.sum","via_path":["items"]}],
      "inlining_decisions": {"op_0":{"producer":"items_subtotal","decision":"inline","use_site_axes":["items"]}}
    },
    "cart_total_effective": {
      "name": "cart_total_effective",
      "axes": [],
      "parameters": [{"kind":"dependency","source":"items_effective"}],
      "result_id": 1,
      "site_schedule": {
        "max_depth": 1,
        "hoisted_scalars": [],
        "root_reduces": [{"id":1,"kind":"reduce"}],
        "by_depth": [{"depth":0,"ops":[{"id":1,"kind":"reduce"}]},{"depth":1,"ops":[{"id":0,"kind":"loaddeclaration"}]}]
      },
      "axis_carriers": [],
      "reduce_plans": [{"op_id":0,"axis":"items","result_depth":0,"arg_id":0,"reducer_fn":"agg.sum","via_path":["items"]}],
      "inlining_decisions": {"op_0":{"producer":"items_effective","decision":"inline","use_site_axes":["items"]}}
    }
  }
}