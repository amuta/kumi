(NAST
  (TRAIT x_is_large
    (Call :"core.gt"
    (InputRef [:points, :x])
    (Const 100)
  )
  )
  (VALUE selected_value
    (Call :__select__
    (Ref x_is_large)
    (InputRef [:points, :x])
    (InputRef [:points, :y])
  )
  )
  (VALUE final_value_per_point
    (Call :"agg.max"
    (Tuple
      (Ref selected_value)
      (InputRef [:points, :x])
    )
  )
  )
  (VALUE grand_total
    (Call :"agg.sum"
    (Ref final_value_per_point)
  )
  )
)